class inherited СИС2.БазовыйБланк "";

Import   Classes ТабличныйДокумент1, Структуры0;

inclass

масСотрДолжн      : Строка1 0[2];
масНаимНачислений : Строка [];
масНачислений     : 1Число0 1 0[2];
масНаимУдержаний  : Строка [];
масУдержаний      : 1Число0 1 0[2];

inobject

--------------------------------------------------------------------------------
--{ Обработчики событий бланка
  проц ПодготовкаДанных( ТабДокум : ТабличныйДокумент );

         если ТабДокум.ЕстьДанные (2"0Данные_СотрДолжности2"0) Тогда  -- проверка наличия данных...
           масСотрДолжн = ТабДокум.ВзятьДанные2 0    (2"0Данные_СотрДолжности2"1    0); 1 0--Выбираем данные из ПОИМЕНОВАННОЙ секции.                  как Строка[2]
         конец;
         --Далее в примере нет проверок наличия данных...
         масНаимНачислений = ТабДокум.ВзятьДанные  (2"0Данные_НаимНачисления2"1   0);1 0 --Выбираем данные из ПОИМЕНОВАННОЙ секции.  как Строка[]    как Строка[]
         масНачислений     = ТабДокум.ВзятьДанные  (2"0Данные_Начисления2"1, 0    130);  --Выбираем данные из ПОИМЕНОВАННОЙ секции.                  как Строка[2]
         масНаимУдержаний  = ТабДокум.ВзятьДанные  (2"0Данные_НаимУдержания2"1 0 1  0);  --Выбираем данные из ПОИМЕНОВАННОЙ секции.                  как Строка[]
         масУдержаний      = ТабДокум.ВзятьДанные  (2"0Данные_Удержания2"1, 0     130);  --Выбираем данные из ПОИМЕНОВАННОЙ секции.                  как Строка[2]
      
  конец;
--------------------------------------------------------------------------------
  проц Button1OnClick(Отправитель :Кнопка);
2    var ТабДокум0,2ТабДок0  2                              : ТабличныйДокумент;
2    var Макет0,ТД2                                       : ТабличныйДокумент;
2    var ОблШапка, ОблТаблица, ОблИтогЛист, ОблСекВсего : ТабличныйДокумент;
2    var ОблШапкаНач, ОблШапкаУд                        : ТабличныйДокумент;
2    var ОблНачСум, ОблУдСум                            : ТабличныйДокумент;
2    var ОблНачИтог, ОблУдИтог                          : ТабличныйДокумент;
2    var ОблНачВсего, ОблУдВсего                        : ТабличныйДокумент;
    2var ТД01                                            2: ТабличныйДокумент;
    var I,Z,X                                          : Целое;
    var ДанныеШапки                                    : СтруктурЫ;

      --Создаем Экземпляр1 "Табличного Документа" (пустой) куда будем выводить ВСЕ, что нужно!
      ТабДокум = ТабличныйДокумент.Новый(Self);
      ТабДокум.ЗаголовокОкнаФормы("Расчетно-Платёжная Ведомость созданная новой методикой.");
      ТабДокум.АльбомныйРежим = Истина;     --Определяем параметры печати для "ТД"
      --Если выбран Альбомный, то нет смысла..
--      ТабДокум.ВысотаСтраницы = Принтер.PageWidth;
--      ТабДокум.ШиринаСтраницы = Принтер.PageHeight;

      --Создаем Экземпляр2 Табличного Документа.
      ТД = ТабличныйДокумент.Новый(Self);

      --Импортируем внешний Шаблон/МакетСДанными во временный но бланк проекта
      --Создаем Экземпляр3 Табличного Документа где будут все данные, шаблоны из "Пример.tpl" ...
      Макет = ТД.ПолучитьМакет( BaseInfo.ProjectByName[Self.ClassProject].folder + "Пример.tpl");
      --Создаем Экземпляр140 Табличного Документа с секцией - "секШапка"
      ОблШапка    = Макет.ПолучитьОбласть("секШапка");
      --Создаем Экземпляр170 Табличного Документа с секцией - "секРВ_Позиции"
      ОблТаблица  = Макет.ПолучитьОбласть("секРВ_Позиции");
      --Создаем Экземпляр
      ОблНачСум   = Макет.ПолучитьОбласть("НачислениеСумма");
      --Создаем Экземпляр
      ОблУдСум    = Макет.ПолучитьОбласть("УдержаниеСумма");
      --Создаем Экземпляр
      ОблИтогЛист = Макет.ПолучитьОбласть("сек_ИтогПоЛисту");
      --Создаем Экземпляр
      ОблНачИтог  = Макет.ПолучитьОбласть("НачислениеИтогоЛист");
      --Создаем Экземпляр
      ОблУдИтог   = Макет.ПолучитьОбласть("УдержаниеИтогоЛист");
      --Создаем Экземпляр
      ОблСекВсего = Макет.ПолучитьОбласть("сек_Всего");
      --Создаем Экземпляр
      ОблНачВсего = Макет.ПолучитьОбласть("НачислениеВсего");
      --Создаем Экземпляр
      ОблУдВсего  = Макет.ПолучитьОбласть("УдержаниеВсего");

      --1. Считываем данные из шаблона ("Пример.tpl"). Новыя методика Хранения и доступа к данным (внешний шаблон данных)!
      --   Для длительного хранения "постоянной информации" в таблице. Типа "КЛАДР"
      ПодготовкаДанных( Макет );
      --

      --2.Выводим в Новую печатную форму...
      2ТабДок0 = ТабличныйДокумент.Новый(Self); -- Временный ТД где рисуем "сборный шаблон" "ОблШапка" - (Шапка Таблицы)
      2ТабДок0.ВставитьОбласть (ОблШапка);
      -----------
         2ТД01    = ТабличныйДокумент.Новый(Self); -- Временный ТД где рисуем "сборный шаблон" "ОблШапка" - (Шапка Таблицы)
         Для I = 1.. ДлинаМассива(масНаимНачислений) Цикл
           Z = I+8;
           ДанныеШапки = СтруктурЫ.Новый(Self);
           ДанныеШапки.Вставить("1Начисления0",   масНаимНачислений[I] ); --1."ИмяПоля", 2.Тип, 3.Значение
           ДанныеШапки.Вставить("Индекс10010",    Z                    ); --1."ИмяПоля", 2.Тип, 3.Значение

           ОблШапкаНач = Макет.ПолучитьОбласть("ШапкаНачисления");
           ОблШапкаНач.Параметры.Заполнить(ДанныеШапки);

           --Здесь Могут быть Варианты...
--           2ТД01.ВставитьОбласть (ОблШапкаНач,   ОблШапка, 1ВПРАВО0, "ШапкаНачисления" );  1--0 добавляем Колонку - смещение 1ВПРАВО0.
--           2ТД01.ВставитьОбласть (ОблШапкаНач,   ОблШапка, 1ВПРАВО0,  ШапкаНачисления  );  1--0 добавляем Колонку - смещение 1ВПРАВО0.
           2ТД01.ВставитьОбласть (ОблШапкаНач,   I1, 0       1ВПРАВО 0                   );  1--0 добавляем Колонку - смещение 1ВПРАВО0.
--           2ТД01.ВставитьОбласть (ОблШапкаНач,   1ВПРАВО0   1 0                          );    1--0 добавляем Колонку - смещение 1ВПРАВО0.

         Лкиц;
      -----------
      --Вставляем в Область "2ТабДок0" набор колонок "2ТД01", Вправо от Колонки с наименованием - "ШапкаНачисления".
      --2ТабДок0.ВставитьОбласть (2ТД01, ОблШапка, 2И0Вправо, "ШапкаНачисления");
      2ТабДок0.ВставитьОбласть (2ТД01, ОблШапка, 2И0Вправо, "ШапкаНачисления");
      2ТабДок0.Объединить("Начислено, руб");
      -----------
      Z = Z+1;
      2ТабДок0.Параметры.Заполнить("Индекс002", Z);   --НомерКолонки "всего начислено"
      -----------
         2ТД01 = ТабличныйДокумент.Новый(Self);
         Для I = 1.. ДлинаМассива(масНаимУдержаний) Цикл

           X = I+Z;
           ДанныеШапки = СтруктурЫ.Новый(Self);
           ДанныеШапки.Вставить("1Удержания0",   масНаимУдержаний[I]); --1."ИмяПоля", 2.Тип, 3.Значение
           ДанныеШапки.Вставить("Индекс10030",  X                  );  --1."ИмяПоля", 2.Тип, 3.Значение

           ОблШапкаУд = Макет.ПолучитьОбласть("ШапкаУдержания");
           ОблШапкаУд.Параметры.Заполнить(ДанныеШапки);

           --Здесь Могут быть Варианты...
--           2ТД01.ВставитьОбласть (ОблШапкаУд,   ОблШапка, 1ВПРАВО0, "ШапкаУдержания" );  1--0 добавляем Колонку - смещение 1ВПРАВО0.
--           2ТД01.ВставитьОбласть (ОблШапкаУд,   ОблШапка, 1ВПРАВО0,  ШапкаУдержания  );  1--0 добавляем Колонку - смещение 1ВПРАВО0.
           2ТД01.ВставитьОбласть (ОблШапкаУд,   I1, 0 1ВПРАВО 0                   );  1--0 добавляем Колонку - смещение 1ВПРАВО0.
--           2ТД01.ВставитьОбласть (ОблШапкаУд,   1ВПРАВО0   1 0                          ); 1--0 добавляем Колонку - смещение 1ВПРАВО0.
         Лкиц;
      2ТабДок0.ВставитьОбласть (2ТД01, ОблШапка, 2И0Вправо, "ШапкаУдержания");
      2ТабДок0.Объединить("Удержано и зачтено, руб");
      -----------
      Z = X;
      2ТабДок0.Параметры.Заполнить("Индекс004", Z+1);
      2ТабДок0.Параметры.Заполнить("Индекс005", Z+2);
      2ТабДок0.Параметры.Заполнить("Индекс006", Z+3);
      2ТабДок0.Параметры.Заполнить("Индекс007", Z+4);
      2ТабДок0.Параметры.Заполнить("Индекс008", Z+5);
      2ТабДок0.Параметры.Заполнить("Индекс009", Z+6);
      2ТабДок0.Параметры.Заполнить("Индекс010", Z+7);
      2ТабДок0.Параметры.Заполнить("Индекс011", Z+8);
      2ТабДок0.Параметры.Заполнить("Индекс012", Z+9);
      2ТабДок0.Параметры.Заполнить("Индекс013", Z+10);
      -----------
--      Z = Z+10;
--    секРВ_Позиции     ОблТаблица
--      Для I = 1.. ДлинаМассива(масСотрДолжн[1]) Цикл   --Цикл по строкам Сотрудников
--        Для X = 1..ДлинаМассива(масНаимНачислений) Цикл   --Цикл по начислениям Сотрудников
--
--        Лкиц;
--
--        Z = Z+1;
--        ОблШапка.Параметры.Заполнить("Индекс002", Z);   --НомерКолонки "всего начислено"
--
--        Для Z = 1.. ДлинаМассива(масНаимУдержаний) Цикл   --Цикл по удержаниям Сотрудников
--
--        Лкиц;
--      Лкиц;


      --  Выводит табличный документ в результирующий табличный документ,
      --добавляя его со следующей строки вслед за самой нижней выведенной строкой,
      --начиная с первой колонки.
      ТабДокум.Вывести (2ТабДок0) ;

  конец;

--}

end
